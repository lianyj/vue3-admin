import{_ as e}from"./element-plus.392249c9.js";import"./index.5b6ae43b.js";import"./vue.6371db79.js";import{a}from"./axios.6127bb87.js";import{a8 as l,a9 as t,P as r,R as o,o as d,d as s,N as u,f as i,F as n,S as p,u as m,l as f,aa as c,U as h}from"./@vue.07e3533d.js";import"./dayjs.2a17732a.js";import"./lodash.ebb3c926.js";import"./mitt.33133208.js";import"./async-validator.e3a73323.js";import"./@popperjs.6ab8fae4.js";import"./resize-observer-polyfill.06552ccc.js";import"./normalize-wheel.d56ec257.js";import"./@sentry.2890fdbd.js";import"./tslib.e2371a99.js";import"./vue-router.b8b6d224.js";const b={name:"Order",data:()=>({formModel:{orderNo:"",orderStatus:null,expressStatus:null,userId:null,orderTime:[]},data:{},userList:[],dialogVisible:!1,loading:!1,tableData:[],total:0,currentPage:1,pageSize:10}),methods:{getOrderList(){this.loading=!0,a.get("/orders",{params:{pageNumber:this.currentPage,pageSize:this.pageSize,orderNo:this.formModel.orderNo,orderStatus:this.formModel.orderStatus,expressStatus:this.formModel.expressStatus,userId:this.formModel.userId,startTime:this.formModel.orderTime[0],endTime:this.formModel.orderTime[1]}}).then((e=>{console.log(e),this.tableData=e.list,this.total=e.totalCount,this.currentPage=e.currPage,this.loading=!1}))},addOrder(){a.post("/order/save",{userId:this.data.userId,orderDate:this.data.orderDate,expressFee:this.data.expressFee,remark:this.data.remark,payType:this.data.payType,orderStatus:this.data.orderStatus,expressStatus:this.data.expressStatus}).then((e=>{console.log(e),this.dialogVisible=!1,this.getOrderList()}))},changeOrderStatus(e,l){a.get("/orders/status/change",{params:{orderId:e,orderStatus:l}}).then((e=>{console.log(e),this.getOrderList()}))},changeExpressStatus(e,l){a.get("/orders/express/change",{params:{orderId:e,expressStatus:l}}).then((e=>{console.log(e),this.getOrderList()}))},changePage(e){this.currentPage=e,getOrderList()},handleClose(){this.dialogVisible=!1},orderClose(l){a.get("/orders/close?orderId="+l).then((()=>{e.success("关闭成功"),this.getOrderList()}))},getUserList(){a.get("/user/allList").then((e=>{console.log(e),this.userList=e}))}},watch:{"data.userId":{handler(e,a){for(const l in this.userList)if(this.userList[l].userId===e){this.data.userName=this.userList[l].userName,this.data.contactName=this.userList[l].contactName,this.data.mobile=this.userList[l].mobile,this.data.address=this.userList[l].address;break}}}},created(){this.getOrderList(),this.getUserList()}},g=c("data-v-3c1ef684");l("data-v-3c1ef684");const _={class:"header"},V=h("待支付"),S=h("已支付"),y=h("已关闭"),x=h("未寄出"),v=h("已寄出"),k=h("搜索"),w=h("新增订单"),I=h("现结"),C=h("月结"),M=h("待支付"),L=h("已支付"),N=h("已关闭"),j=h("未寄出"),z=h("已寄出"),U={class:"dialog-footer"},D=h("取 消"),O=h("新 增"),T=h("订单详情"),P=u("a",{style:{cursor:"pointer","margin-right":"10px",color:"red"}},"关闭订单",-1);t();const Y=g(((e,a,l,t,c,h)=>{const b=r("el-date-picker"),Y=r("el-form-item"),F=r("el-input"),E=r("el-option"),q=r("el-select"),A=r("el-button"),R=r("el-form"),X=r("el-dialog"),B=r("el-table-column"),G=r("router-link"),H=r("el-col"),J=r("el-popconfirm"),K=r("el-table"),Q=r("el-pagination"),W=r("el-card"),Z=o("loading");return d(),s(W,{class:"order-container"},{header:g((()=>[u("div",_,[u(R,{size:"mini",inline:"",modelValue:c.formModel,"onUpdate:modelValue":a[7]||(a[7]=e=>c.formModel=e),style:{width:"100%","font-size":"12px"}},{default:g((()=>[u(Y,{label:"订单日期"},{default:g((()=>[u(b,{modelValue:c.formModel.orderTime,"onUpdate:modelValue":a[1]||(a[1]=e=>c.formModel.orderTime=e),type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),u(Y,{label:"订单号"},{default:g((()=>[u(F,{style:{width:"200px","margin-right":"10px"},placeholder:"请输入订单号",modelValue:c.formModel.orderNo,"onUpdate:modelValue":a[2]||(a[2]=e=>c.formModel.orderNo=e),size:"mini",clearable:""},null,8,["modelValue"])])),_:1}),u(Y,{label:"订单状态"},{default:g((()=>[u(q,{modelValue:c.formModel.orderStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>c.formModel.orderStatus=e),placeholder:"请选择订单状态",size:"mini",style:{width:"200px","margin-right":"10px"},clearable:""},{default:g((()=>[u(E,{label:"待支付",value:"1"},{default:g((()=>[V])),_:1}),u(E,{label:"已支付",value:"2"},{default:g((()=>[S])),_:1}),u(E,{label:"已关闭",value:"3"},{default:g((()=>[y])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(Y,{label:"快递状态"},{default:g((()=>[u(q,{modelValue:c.formModel.expressStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>c.formModel.expressStatus=e),placeholder:"请选择快递状态",size:"mini",style:{width:"200px","margin-right":"10px"},clearable:""},{default:g((()=>[u(E,{label:"未寄出",value:"1"},{default:g((()=>[x])),_:1}),u(E,{label:"已寄出",value:"2"},{default:g((()=>[v])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(Y,{label:"客户ID"},{default:g((()=>[u(F,{style:{width:"200px","margin-right":"10px"},placeholder:"请输入客户ID",modelValue:c.formModel.userId,"onUpdate:modelValue":a[5]||(a[5]=e=>c.formModel.userId=e),size:"mini",clearable:""},null,8,["modelValue"])])),_:1}),u(A,{size:"mini",type:"primary",onClick:h.getOrderList},{default:g((()=>[k])),_:1},8,["onClick"]),u(A,{size:"mini",type:"danger",onClick:a[6]||(a[6]=e=>c.dialogVisible=!0)},{default:g((()=>[w])),_:1}),i('          <el-button size="mini" type="warning" @click="handleAdd">导出</el-button>')])),_:1},8,["modelValue"])])])),default:g((()=>[u(X,{title:"提示",modelValue:c.dialogVisible,"onUpdate:modelValue":a[16]||(a[16]=e=>c.dialogVisible=e),width:"60%","before-close":h.handleClose},{footer:g((()=>[u("span",U,[u(A,{onClick:a[15]||(a[15]=e=>c.dialogVisible=!1)},{default:g((()=>[D])),_:1}),u(A,{type:"primary",onClick:h.addOrder},{default:g((()=>[O])),_:1},8,["onClick"])])])),default:g((()=>[u(R,{ref:"form",model:c.data,"label-width":"80px"},{default:g((()=>[u(Y,{label:"选择用户"},{default:g((()=>[u(q,{modelValue:c.data.userId,"onUpdate:modelValue":a[8]||(a[8]=e=>c.data.userId=e),filterable:"",placeholder:"请选择"},{default:g((()=>[(d(!0),s(n,null,p(c.userList,(e=>(d(),s(E,{key:e.userId,label:e.userName+"-"+e.contactName+"-"+e.userLevelStr,value:e.userId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),u(Y,{label:"客户名称"},{default:g((()=>[u("span",null,[u("label",null,m(c.data.userName),1)])])),_:1}),u(Y,{label:"联系人"},{default:g((()=>[u("span",null,[u("label",null,m(c.data.contactName),1)])])),_:1}),u(Y,{label:"联系电话"},{default:g((()=>[u("span",null,[u("label",null,m(c.data.mobile),1)])])),_:1}),u(Y,{label:"联系地址"},{default:g((()=>[u("span",null,[u("label",null,m(c.data.address),1)])])),_:1}),u(Y,{label:"订单日期"},{default:g((()=>[u("span",null,[u(b,{modelValue:c.data.orderDate,"onUpdate:modelValue":a[9]||(a[9]=e=>c.data.orderDate=e),type:"date",placeholder:"选择日期",clearable:""},null,8,["modelValue"])])])),_:1}),u(Y,{label:"快递费用"},{default:g((()=>[u("span",null,[u(F,{modelValue:c.data.expressFee,"onUpdate:modelValue":a[10]||(a[10]=e=>c.data.expressFee=e),style:{width:"50%"},clearable:""},null,8,["modelValue"])])])),_:1}),u(Y,{label:"支付方式"},{default:g((()=>[u(q,{modelValue:c.data.payType,"onUpdate:modelValue":a[11]||(a[11]=e=>c.data.payType=e),filterable:"",placeholder:"请选择"},{default:g((()=>[u(E,{label:"现结",value:"X"},{default:g((()=>[I])),_:1}),u(E,{label:"月结",value:"Y"},{default:g((()=>[C])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(Y,{label:"订单状态"},{default:g((()=>[u(q,{modelValue:c.data.orderStatus,"onUpdate:modelValue":a[12]||(a[12]=e=>c.data.orderStatus=e),filterable:"",placeholder:"请选择"},{default:g((()=>[u(E,{label:"待支付",value:"1"},{default:g((()=>[M])),_:1}),u(E,{label:"已支付",value:"2"},{default:g((()=>[L])),_:1}),u(E,{label:"已关闭",value:"3"},{default:g((()=>[N])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(Y,{label:"快递状态"},{default:g((()=>[u(q,{modelValue:c.data.expressStatus,"onUpdate:modelValue":a[13]||(a[13]=e=>c.data.expressStatus=e),filterable:"",placeholder:"请选择"},{default:g((()=>[u(E,{label:"未寄出",value:"1"},{default:g((()=>[j])),_:1}),u(E,{label:"已寄出",value:"2"},{default:g((()=>[z])),_:1})])),_:1},8,["modelValue"])])),_:1}),u(Y,{label:"备注"},{default:g((()=>[u("span",null,[u(F,{modelValue:c.data.remark,"onUpdate:modelValue":a[14]||(a[14]=e=>c.data.remark=e),style:{width:"50%"},clearable:""},null,8,["modelValue"])])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"]),f(u(K,{data:c.tableData,"tooltip-effect":"dark",style:{width:"100%"}},{default:g((()=>[u(B,{prop:"orderNo",label:"订单号"}),u(B,{prop:"userId",label:"客户ID"}),u(B,{prop:"userName",label:"客户名称"}),u(B,{prop:"contactName",label:"联系人"}),u(B,{prop:"userLevelStr",label:"客户等级"}),u(B,{prop:"totalPrice",label:"订单总价"}),u(B,{prop:"orderStatusStr",label:"订单状态"}),u(B,{prop:"expressStatusStr",label:"快递状态"}),u(B,{prop:"orderDate",label:"订单时间"}),u(B,{label:"操作"},{default:g((e=>[u(H,null,{default:g((()=>[u(G,{to:{path:"/order_detail",query:{id:e.row.orderId}}},{default:g((()=>[T])),_:2},1032,["to"])])),_:2},1024),u(H,null,{default:g((()=>[1===e.row.orderStatus&&3!==e.row.orderStatus?(d(),s("a",{key:0,onClick:a=>h.changeOrderStatus(e.row.orderId,2)},"支付成功",8,["onClick"])):i("v-if",!0)])),_:2},1024),u(H,null,{default:g((()=>[2===e.row.orderStatus&&3!==e.row.orderStatus?(d(),s("a",{key:0,style:{color:"green"},onClick:a=>h.changeOrderStatus(e.row.orderId,1)},"还未支付",8,["onClick"])):i("v-if",!0)])),_:2},1024),u(H,null,{default:g((()=>[1===e.row.expressStatus&&3!==e.row.orderStatus?(d(),s("a",{key:0,onClick:a=>h.changeExpressStatus(e.row.orderId,2)},"快递已寄",8,["onClick"])):i("v-if",!0)])),_:2},1024),u(H,null,{default:g((()=>[2===e.row.expressStatus&&3!==e.row.orderStatus?(d(),s("a",{key:0,style:{color:"green"},onClick:a=>h.changeExpressStatus(e.row.orderId,1)},"快递未寄",8,["onClick"])):i("v-if",!0)])),_:2},1024),u(H,null,{default:g((()=>[2===e.row.orderStatus&&2===e.row.expressStatus?(d(),s(J,{key:0,title:"确定关闭订单吗？",onConfirm:a=>h.orderClose(e.row.orderId)},{reference:g((()=>[P])),_:2},1032,["onConfirm"])):i("v-if",!0)])),_:2},1024)])),_:1})])),_:1},8,["data"]),[[Z,c.loading]]),u(Q,{background:"",layout:"prev, pager, next",total:c.total,"page-size":c.pageSize,"current-page":c.currentPage,onCurrentChange:h.changePage},null,8,["total","page-size","current-page","onCurrentChange"])])),_:1})}));b.render=Y,b.__scopeId="data-v-3c1ef684";export{b as default};
